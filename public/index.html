<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Celebration of Zaid & Munawwarah</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Instrument+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            /* Ijab & Qabul - Sacred Night */
            --ijab-bg: #FAF9F6;
            --ijab-bg-alt: #F5F3EE;
            --ijab-text: #2C2C2C;
            --ijab-text-soft: #6B6B6B;
            --ijab-accent: #B8A88A;

            /* Sanding - Grandeur */
            --sanding-bg: #4A1C1C;
            --sanding-bg-alt: #3D1717;
            --sanding-text: #F5E6D3;
            --sanding-text-soft: #D4C4B0;
            --sanding-accent: #C9A227;

            /* Tandang - Journey */
            --tandang-bg: #E8F4F8;
            --tandang-bg-alt: #D6EBF2;
            --tandang-text: #1E3A4F;
            --tandang-text-soft: #4A6B7C;
            --tandang-accent: #8FB8C9;

            /* Handwriting Ink Colors */
            --ink-navy: #1a365d;
            --ink-sepia: #5c4033;
            --ink-gold: #b8860b;
            --ink-cream: #f5e6d3;

            --transition-slow: 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-medium: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: 0.2s ease;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Instrument Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--ijab-bg);
            color: var(--ijab-text);
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color var(--transition-slow), color var(--transition-slow);
        }

        /* Theme States */
        body.theme-ijab {
            background-color: var(--ijab-bg);
            color: var(--ijab-text);
        }

        body.theme-sanding {
            background-color: var(--sanding-bg);
            color: var(--sanding-text);
        }

        body.theme-tandang {
            background-color: var(--tandang-bg);
            color: var(--tandang-text);
        }

        /* Typography */
        .serif {
            font-family: 'Cormorant Garamond', Georgia, serif;
        }

        .text-soft {
            opacity: 0.65;
        }

        /* ===== HERO SECTION ===== */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            padding: 2rem;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(ellipse at 30% 20%, rgba(184, 168, 138, 0.08) 0%, transparent 50%),
                        radial-gradient(ellipse at 70% 80%, rgba(184, 168, 138, 0.05) 0%, transparent 50%);
            pointer-events: none;
            transition: opacity var(--transition-slow);
        }

        body.theme-sanding .hero::before {
            background: radial-gradient(ellipse at 30% 20%, rgba(201, 162, 39, 0.1) 0%, transparent 50%),
                        radial-gradient(ellipse at 70% 80%, rgba(201, 162, 39, 0.05) 0%, transparent 50%);
        }

        body.theme-tandang .hero::before {
            background: radial-gradient(ellipse at 30% 20%, rgba(143, 184, 201, 0.15) 0%, transparent 50%),
                        radial-gradient(ellipse at 70% 80%, rgba(143, 184, 201, 0.1) 0%, transparent 50%);
        }

        .hero-content {
            text-align: center;
            z-index: 1;
            max-width: 900px;
        }

        .hero-prelude {
            font-size: 0.75rem;
            letter-spacing: 0.35em;
            text-transform: uppercase;
            margin-bottom: 3rem;
            opacity: 0.5;
        }

        .hero-title {
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-weight: 300;
            font-size: clamp(2.5rem, 8vw, 6rem);
            line-height: 1.1;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
        }

        .hero-title .highlight {
            font-style: italic;
            font-weight: 400;
        }

        .hero-ampersand {
            display: block;
            font-size: 0.5em;
            opacity: 0.4;
            margin: 0.5rem 0;
        }

        .hero-date {
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-size: 1.25rem;
            font-weight: 300;
            letter-spacing: 0.1em;
            margin-top: 3rem;
            opacity: 0.6;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 3rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
            opacity: 0.4;
            animation: float 3s ease-in-out infinite;
        }

        .scroll-indicator span {
            font-size: 0.65rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
        }

        .scroll-indicator svg {
            width: 20px;
            height: 20px;
        }

        @keyframes float {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(8px); }
        }

        /* ===== GALLERY SECTIONS ===== */
        .gallery-section {
            min-height: 100vh;
            padding: 8rem 2rem;
            position: relative;
            transition: background-color var(--transition-slow);
        }

        .section-header {
            max-width: 800px;
            margin: 0 auto 6rem;
            text-align: center;
        }

        .section-label {
            font-size: 0.7rem;
            letter-spacing: 0.4em;
            text-transform: uppercase;
            opacity: 0.4;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-weight: 300;
            font-size: clamp(2rem, 5vw, 3.5rem);
            line-height: 1.2;
            margin-bottom: 1.5rem;
        }

        body.theme-ijab .section-title {
            font-weight: 300;
        }

        body.theme-sanding .section-title {
            font-weight: 400;
        }

        body.theme-tandang .section-title {
            font-weight: 300;
        }

        .section-date {
            font-size: 0.85rem;
            opacity: 0.5;
            letter-spacing: 0.15em;
        }

        /* Sanding Section Specific */
        .gallery-section.section-sanding {
            background-color: var(--sanding-bg);
            color: var(--sanding-text);
        }

        .gallery-section.section-sanding .section-title {
            color: var(--sanding-text);
        }

        /* Tandang Section Specific */
        .gallery-section.section-tandang {
            background-color: var(--tandang-bg);
            color: var(--tandang-text);
        }

        /* ===== MASONRY GRID (Pinterest-style columns) ===== */
        .masonry-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .masonry-grid {
            column-count: 3;
            column-gap: 2rem; /* 32px gap for gallery wall feel */
        }

        @media (max-width: 1024px) {
            .masonry-grid {
                column-count: 2;
                column-gap: 1.5rem;
            }
        }

        @media (max-width: 640px) {
            .masonry-grid {
                column-count: 1;
                column-gap: 0;
            }

            /* Tighter mobile spacing for edge-to-edge photos */
            .gallery-section {
                padding-left: 0.75rem; /* 12px - tight horizontal padding */
                padding-right: 0.75rem;
            }

            .masonry-container {
                padding: 0 0.25rem; /* Minimal container padding */
            }

            /* Caption flush with photo edge on mobile */
            .photo-caption {
                padding-left: 0.25rem; /* Flush alignment with photo */
                padding-right: 0.25rem;
            }
        }

        /* Photo Card - contains photo + handwritten caption */
        .photo-card {
            break-inside: avoid;
            margin-bottom: 2.5rem; /* More vertical spacing */
            position: relative;
            /* Scroll-in entrance animation - starts hidden */
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        /* Visible state - triggered by Intersection Observer */
        .photo-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Photo item styles - NO CROPPING, NO HOVER */
        .photo-item {
            position: relative;
            overflow: hidden;
            border-radius: 3px;
        }

        /* Inner glow effect */
        .photo-item::after {
            content: '';
            position: absolute;
            inset: 0;
            box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.08);
            pointer-events: none;
            z-index: 1;
            border-radius: 3px;
        }

        .photo-item img {
            width: 100%;
            height: auto;
            object-fit: contain;
            display: block;
        }

        /* Handwritten Caption - Left-aligned editorial style */
        .photo-caption {
            position: relative;
            margin-top: 12px; /* 12px separation from photo */
            padding-left: 1rem; /* Consistent left padding (pl-4) */
            padding-right: 1rem;
            text-align: left; /* Left-aligned for clean editorial look */
            max-width: 90%; /* Prevent awkward text wrapping on mobile */
        }

        .photo-name {
            font-family: 'Caveat', cursive;
            font-size: 1.6rem; /* Slightly larger for hierarchy */
            font-weight: 700; /* Bolder for emphasis */
            line-height: 1.2;
            color: var(--ijab-text); /* Deep charcoal for off-white theme */
            margin-bottom: 0.15rem;
        }

        .photo-message {
            font-family: 'Caveat', cursive;
            font-size: 1.35rem; /* 2px smaller than name for hierarchy */
            font-weight: 400;
            line-height: 1.35;
            color: var(--ijab-text-soft); /* Softer charcoal */
        }

        /* Theme-specific handwriting colors - Night (Off-white theme) */
        .section-ijab .photo-name,
        body.theme-ijab .photo-name {
            color: var(--ijab-text); /* Deep charcoal #2C2C2C */
        }
        .section-ijab .photo-message,
        body.theme-ijab .photo-message {
            color: var(--ijab-text-soft); /* Soft charcoal #6B6B6B */
        }

        /* Theme-specific handwriting colors - Grandeur (Maroon theme) */
        .section-sanding .photo-name,
        body.theme-sanding .photo-name {
            color: var(--sanding-accent); /* Soft gold #C9A227 */
        }
        .section-sanding .photo-message,
        body.theme-sanding .photo-message {
            color: var(--sanding-text-soft); /* Warm cream #D4C4B0 */
        }

        /* Theme-specific handwriting colors - Journey (Cool blue theme) */
        .section-tandang .photo-name,
        body.theme-tandang .photo-name {
            color: var(--tandang-text); /* Deep navy #1E3A4F */
        }
        .section-tandang .photo-message,
        body.theme-tandang .photo-message {
            color: var(--tandang-text-soft); /* Soft slate #4A6B7C */
        }

        /* Photo card without caption (anonymous, no message) */
        .photo-card.no-caption .photo-caption {
            display: none;
        }

        .photo-card.no-caption {
            margin-bottom: 2rem;
        }

        /* Empty state */
        .empty-state {
            column-span: all;
            text-align: center;
            padding: 6rem 2rem;
        }

        .empty-state-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 2rem;
            opacity: 0.2;
        }

        .empty-state-title {
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-size: 1.5rem;
            font-weight: 300;
            margin-bottom: 0.75rem;
            opacity: 0.6;
        }

        .empty-state-text {
            font-size: 0.875rem;
            opacity: 0.4;
        }

        .empty-state-cta {
            font-family: 'Caveat', cursive;
            font-size: 1.1rem;
            margin-top: 1.5rem;
            opacity: 0.5;
        }

        /* ===== FLOATING NAVIGATION ===== */
        .floating-nav {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 50;
            display: flex;
            gap: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
            transition: all var(--transition-medium);
        }

        body.theme-sanding .floating-nav {
            background: rgba(77, 34, 34, 0.6);
            border-color: rgba(201, 162, 39, 0.2);
        }

        body.theme-tandang .floating-nav {
            background: rgba(255, 255, 255, 0.5);
            border-color: rgba(143, 184, 201, 0.3);
        }

        .nav-item {
            padding: 0.75rem 1.5rem;
            font-size: 0.8rem;
            font-weight: 500;
            letter-spacing: 0.05em;
            color: inherit;
            background: transparent;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: background var(--transition-fast), color var(--transition-fast);
            white-space: nowrap;
            opacity: 0.7;
        }

        .nav-item.active {
            opacity: 1;
            background: rgba(255, 255, 255, 0.15);
        }

        body.theme-sanding .nav-item.active {
            background: rgba(201, 162, 39, 0.25);
            color: var(--sanding-accent);
        }

        body.theme-tandang .nav-item.active {
            background: rgba(30, 58, 79, 0.12);
            color: var(--tandang-text);
        }

        @media (max-width: 640px) {
            .floating-nav {
                bottom: 1.5rem; /* 24px from bottom edge */
                padding: 0.5rem 0.625rem; /* Comfortable pill padding */
            }
            .nav-item {
                padding: 0.625rem 1rem;
                font-size: 0.75rem;
            }
        }

        /* ===== UPLOAD BUTTON (Iconic CTA) ===== */
        .upload-cta {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 50;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: 1px solid currentColor;
            background: transparent;
            color: inherit;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.5;
            transition: opacity var(--transition-fast);
        }

        .upload-cta:hover {
            opacity: 0.8;
        }

        .upload-cta svg {
            width: 24px;
            height: 24px;
            stroke-width: 1;
        }

        body.theme-sanding .upload-cta {
            border-color: var(--sanding-accent);
            color: var(--sanding-accent);
        }

        body.theme-tandang .upload-cta {
            border-color: var(--tandang-text);
            color: var(--tandang-text);
            border-radius: 28px;
        }

        .upload-cta.hidden {
            display: none;
        }

        @media (max-width: 640px) {
            .upload-cta {
                bottom: 5rem;
                right: 1rem;
                width: 48px;
                height: 48px;
            }
        }

        /* ===== UPLOAD MODAL ===== */
        .modal-overlay {
            position: fixed;
            inset: 0;
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-medium);
        }

        .modal-overlay.visible {
                opacity: 1;
            visibility: visible;
        }

        .modal-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
        }

        .modal-content {
            position: relative;
            width: 100%;
            max-width: 480px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: translateY(20px) scale(0.95);
            transition: transform var(--transition-medium);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-overlay.visible .modal-content {
            transform: translateY(0) scale(1);
        }

        body.theme-sanding .modal-content {
            background: rgba(77, 34, 34, 0.95);
            border-color: rgba(201, 162, 39, 0.3);
        }

        body.theme-tandang .modal-content {
            background: rgba(232, 244, 248, 0.98);
            border-color: rgba(143, 184, 201, 0.5);
            border-radius: 32px;
        }

        .modal-close {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            cursor: pointer;
            opacity: 0.4;
            transition: opacity var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            opacity: 1;
        }

        .modal-close svg {
            width: 20px;
            height: 20px;
        }

        body.theme-sanding .modal-close {
            color: var(--sanding-text);
        }

        .modal-header {
            padding: 2.5rem 2.5rem 0;
            text-align: center;
        }

        .modal-title {
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-size: 1.75rem;
            font-weight: 300;
            color: #2C2C2C;
            margin-bottom: 0.5rem;
        }

        body.theme-sanding .modal-title {
            color: var(--sanding-text);
        }

        body.theme-tandang .modal-title {
            color: var(--tandang-text);
        }

        .modal-subtitle {
            font-size: 0.8rem;
            opacity: 0.5;
            color: #2C2C2C;
        }

        body.theme-sanding .modal-subtitle {
            color: var(--sanding-text-soft);
        }

        body.theme-tandang .modal-subtitle {
            color: var(--tandang-text-soft);
        }

        .modal-form {
            padding: 2rem 2.5rem 2.5rem;
        }

        .upload-zone {
            border: 1px dashed rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            padding: 2.5rem;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-fast);
            margin-bottom: 1.5rem;
            background: rgba(0, 0, 0, 0.02);
        }

        .upload-zone:hover {
            border-color: rgba(0, 0, 0, 0.4);
            background: rgba(0, 0, 0, 0.04);
        }

        body.theme-sanding .upload-zone {
            border-color: rgba(201, 162, 39, 0.3);
            background: rgba(201, 162, 39, 0.05);
        }

        body.theme-sanding .upload-zone:hover {
            border-color: var(--sanding-accent);
            background: rgba(201, 162, 39, 0.1);
        }

        body.theme-tandang .upload-zone {
            border-color: rgba(143, 184, 201, 0.5);
            background: rgba(143, 184, 201, 0.1);
            border-radius: 24px;
        }

        body.theme-tandang .upload-zone:hover {
            border-color: var(--tandang-accent);
        }

        .upload-zone-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 1rem;
            opacity: 0.3;
        }

        body.theme-sanding .upload-zone-icon {
            color: var(--sanding-accent);
            opacity: 0.6;
        }

        .upload-zone-text {
            font-size: 0.85rem;
            color: #2C2C2C;
            opacity: 0.5;
        }

        body.theme-sanding .upload-zone-text {
            color: var(--sanding-text-soft);
        }

        body.theme-tandang .upload-zone-text {
            color: var(--tandang-text-soft);
        }

        .upload-preview {
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .upload-preview img {
            max-width: 100%;
            max-height: 280px;
            width: auto;
            height: auto;
            object-fit: contain;
            border-radius: 8px;
            margin: 0 auto;
            display: block;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .upload-preview-hint {
            font-family: 'Caveat', cursive;
            font-size: 1rem;
            color: var(--ink-sepia);
            opacity: 0.6;
            margin-top: 0.75rem;
        }

        body.theme-sanding .upload-preview-hint {
            color: var(--ink-cream);
        }

        .form-field {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            font-size: 0.7rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
            opacity: 0.5;
            color: #2C2C2C;
        }

        body.theme-sanding .form-label {
            color: var(--sanding-text-soft);
        }

        body.theme-tandang .form-label {
            color: var(--tandang-text-soft);
        }

        .form-input {
            width: 100%;
            padding: 0.875rem 1rem;
            font-family: inherit;
            font-size: 0.9rem;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            background: white;
            color: #2C2C2C;
            transition: all var(--transition-fast);
        }

        /* Handwriting style for name and message inputs */
        .form-input-handwriting {
            font-family: 'Caveat', cursive;
            font-size: 1.25rem;
            color: var(--ink-navy);
            padding: 0.75rem 1rem;
        }

        .form-input-handwriting::placeholder {
            font-family: 'Caveat', cursive;
            color: var(--ink-sepia);
            opacity: 0.4;
        }

        body.theme-sanding .form-input-handwriting {
            color: var(--ink-gold);
        }

        body.theme-sanding .form-input-handwriting::placeholder {
            color: var(--ink-cream);
            opacity: 0.4;
        }

        body.theme-tandang .form-input-handwriting {
            color: var(--tandang-text);
        }

        .form-input:focus {
            outline: none;
            border-color: rgba(0, 0, 0, 0.3);
        }

        body.theme-sanding .form-input {
            background: rgba(61, 23, 23, 0.8);
            border-color: rgba(201, 162, 39, 0.2);
            color: var(--sanding-text);
        }

        body.theme-sanding .form-input:focus {
            border-color: var(--sanding-accent);
        }

        body.theme-sanding .form-input::placeholder {
            color: var(--sanding-text-soft);
            opacity: 0.5;
        }

        body.theme-tandang .form-input {
            background: white;
            border-color: rgba(143, 184, 201, 0.3);
            border-radius: 16px;
        }

        body.theme-tandang .form-input:focus {
            border-color: var(--tandang-accent);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .submit-btn {
            width: 100%;
            padding: 1rem;
            font-family: inherit;
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.05em;
            border: none;
            border-radius: 12px;
            background: #2C2C2C;
            color: white;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .submit-btn:hover {
            background: #1a1a1a;
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        body.theme-sanding .submit-btn {
            background: transparent;
            border: 1px solid var(--sanding-accent);
            color: var(--sanding-accent);
        }

        body.theme-sanding .submit-btn:hover {
            background: rgba(201, 162, 39, 0.15);
        }

        body.theme-tandang .submit-btn {
            background: var(--tandang-text);
            border-radius: 20px;
        }

        body.theme-tandang .submit-btn:hover {
            background: #152a3a;
        }

        /* Event indicator in modal */
        .event-indicator {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            font-size: 0.7rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.05);
            color: #2C2C2C;
            margin-top: 0.75rem;
        }

        body.theme-sanding .event-indicator {
            background: rgba(201, 162, 39, 0.2);
            color: var(--sanding-accent);
        }

        body.theme-tandang .event-indicator {
            background: rgba(143, 184, 201, 0.3);
            color: var(--tandang-text);
        }

        /* ===== DEBUG PANEL ===== */
        .debug-panel {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 300;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            color: white;
            font-size: 0.75rem;
        }

        .debug-panel-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            opacity: 0.6;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .debug-panel button {
            display: block;
            width: 100%;
            padding: 0.5rem 0.75rem;
            margin-top: 0.375rem;
            font-size: 0.7rem;
            border: none;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: background 0.2s;
        }

        .debug-panel button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .debug-panel button.active {
            background: #4CAF50;
        }

        /* ===== LOADING STATE ===== */
        .loading-state {
            column-span: all;
            text-align: center;
            padding: 4rem 2rem;
        }

        .loading-spinner {
            width: 32px;
            height: 32px;
            border: 2px solid currentColor;
            border-top-color: transparent;
            border-radius: 50%;
            margin: 0 auto 1rem;
            animation: spin 1s linear infinite;
            opacity: 0.3;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== UTILITIES ===== */
        .hidden {
            display: none !important;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body class="theme-ijab">

    <!-- Hero Section -->
    <section class="hero" id="hero">
        <div class="hero-content">
            <p class="hero-prelude">A Celebration of Love</p>
            <h1 class="hero-title">
                <span class="highlight">Zaid</span>
                <span class="hero-ampersand">&</span>
                <span class="highlight">Munawwarah</span>
            </h1>
            <p class="hero-date">February 2026</p>
        </div>
        <div class="scroll-indicator">
            <span>Explore</span>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
            </svg>
        </div>
    </section>

    <!-- Night Section (Ijab & Qabul) -->
    <section class="gallery-section section-ijab" id="section-night" data-theme="ijab" data-event="Ijab & Qabul">
        <div class="section-header">
            <p class="section-label">The Sacred Night</p>
            <h2 class="section-title">Ijab & Qabul</h2>
            <p class="section-date">February 7, 2026</p>
        </div>
        <div class="masonry-container">
            <div class="masonry-grid" id="gallery-ijab">
                <!-- Photos loaded dynamically -->
            </div>
        </div>
    </section>

    <!-- Grandeur Section (Sanding) -->
    <section class="gallery-section section-sanding" id="section-grandeur" data-theme="sanding" data-event="Sanding">
        <div class="section-header">
            <p class="section-label">The Grandeur</p>
            <h2 class="section-title">Sanding</h2>
            <p class="section-date">February 8, 2026</p>
        </div>
        <div class="masonry-container">
            <div class="masonry-grid" id="gallery-sanding">
                <!-- Photos loaded dynamically -->
            </div>
        </div>
    </section>

    <!-- Journey Section (Tandang) -->
    <section class="gallery-section section-tandang" id="section-journey" data-theme="tandang" data-event="Tandang">
        <div class="section-header">
            <p class="section-label">The Journey</p>
            <h2 class="section-title">Tandang</h2>
            <p class="section-date">February 14, 2026</p>
        </div>
        <div class="masonry-container">
            <div class="masonry-grid" id="gallery-tandang">
                <!-- Photos loaded dynamically -->
            </div>
        </div>
    </section>

    <!-- Floating Navigation -->
    <nav class="floating-nav" id="floatingNav">
        <button class="nav-item active" data-section="section-night" data-event="Ijab & Qabul">Night</button>
        <button class="nav-item" data-section="section-grandeur" data-event="Sanding">Grandeur</button>
        <button class="nav-item" data-section="section-journey" data-event="Tandang">Journey</button>
    </nav>

    <!-- Upload CTA -->
    <button class="upload-cta hidden" id="uploadCta" aria-label="Share a memory">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M12 5v14M5 12h14" stroke-linecap="round"/>
        </svg>
    </button>

    <!-- Hidden File Input -->
    <input type="file" id="hiddenFileInput" accept="image/*" class="sr-only">

    <!-- Upload Modal -->
    <div class="modal-overlay" id="uploadModal">
        <div class="modal-backdrop" id="modalBackdrop"></div>
        <div class="modal-content">
            <button class="modal-close" id="modalClose">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
            <div class="modal-header">
                <h3 class="modal-title">Share a Memory</h3>
                <p class="modal-subtitle">Add your photo to our collection</p>
                <span class="event-indicator" id="eventIndicator">Night</span>
            </div>
            <form class="modal-form" id="photoForm">
                <div class="upload-zone" id="uploadZone">
                    <input type="file" id="photoFile" accept="image/*" class="sr-only">
                    <div id="uploadPreview">
                        <svg class="upload-zone-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                            <circle cx="8.5" cy="8.5" r="1.5"/>
                            <path d="M21 15l-5-5L5 21"/>
                        </svg>
                        <p class="upload-zone-text">Tap to select a photo</p>
                    </div>
                </div>
                <div class="form-field">
                    <label class="form-label" for="photoName">Your Name</label>
                    <input type="text" id="photoName" class="form-input form-input-handwriting" placeholder="Write your name here...">
                </div>
                <div class="form-field">
                    <label class="form-label" for="photoMessage">Message (Optional)</label>
                    <textarea id="photoMessage" class="form-input form-textarea form-input-handwriting" placeholder="A few words about this moment..."></textarea>
                </div>
                <input type="hidden" id="hiddenEventTag">
                <button type="submit" class="submit-btn" id="uploadBtn">Share Memory</button>
            </form>
        </div>
    </div>

    <script>
        // ===== CONFIGURATION =====
        const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
        const WORKER_URL = isLocalhost
            ? 'http://localhost:8787/api'
            : 'https://wedding-gallery.zaidhuda.workers.dev/api';

        const validPasswords = ['N2026', 'S2026', 'T2026'];
        const urlParams = new URLSearchParams(window.location.search);
        const password = urlParams.get('pass');
        const hasValidPassword = validPasswords.includes(password);
        const debugMode = isLocalhost && (urlParams.get('debug') === 'true' || urlParams.get('test') === 'true');

const EVENT_CONFIG = {
            'Ijab & Qabul': {
                theme: 'ijab',
                section: 'section-night',
                gallery: 'gallery-ijab',
                label: 'Night',
                date: 'February 7, 2026',
                password: 'N2026'
            },
            'Sanding': {
                theme: 'sanding',
                section: 'section-grandeur',
                gallery: 'gallery-sanding',
                label: 'Grandeur',
                date: 'February 8, 2026',
                password: 'S2026'
            },
            'Tandang': {
                theme: 'tandang',
                section: 'section-journey',
                gallery: 'gallery-tandang',
                label: 'Journey',
                date: 'February 14, 2026',
                password: 'T2026'
            }
        };

        let currentEventTag = null;
        let currentTheme = 'ijab';

        // ===== UTILITY FUNCTIONS =====
        function getDefaultEventTag() {
            if (!hasValidPassword) return 'Ijab & Qabul';
            const passwordMap = { 'N2026': 'Ijab & Qabul', 'S2026': 'Sanding', 'T2026': 'Tandang' };
            return passwordMap[password] || 'Ijab & Qabul';
        }

        function isEventDate() {
            if (!hasValidPassword) return false;
            if (debugMode || (isLocalhost && window.debugMode)) return true;

            const today = new Date();
            const todayDate = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()));
            const eventDates = {
                'N2026': new Date(Date.UTC(2026, 1, 7)),
                'S2026': new Date(Date.UTC(2026, 1, 8)),
                'T2026': new Date(Date.UTC(2026, 1, 14))
            };
            return eventDates[password] && todayDate.getTime() === eventDates[password].getTime();
        }

        function applyTheme(theme) {
            document.body.className = `theme-${theme}`;
            currentTheme = theme;
        }

        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
                const r = Math.random() * 16 | 0;
                return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);
            });
        }

        async function resizeImage(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = e => {
                    const img = new Image();
                    img.onload = () => {
                        let { width, height } = img;
                        const maxDimension = 4000;
                        const maxPixels = 12_000_000;

                        if (width > maxDimension || height > maxDimension) {
                            const scale = maxDimension / Math.max(width, height);
                            width *= scale;
                            height *= scale;
                        }

                        if (width * height > maxPixels) {
                            const scale = Math.sqrt(maxPixels / (width * height));
                            width = Math.floor(width * scale);
                            height = Math.floor(height * scale);
                        }

                        const canvas = document.createElement('canvas');
                        canvas.width = width;
                        canvas.height = height;
                        canvas.getContext('2d').drawImage(img, 0, 0, width, height);
                        canvas.toBlob(blob => blob ? resolve(blob) : reject(new Error('Failed to convert')), 'image/jpeg', 0.8);
                    };
                    img.onerror = reject;
                    img.src = e.target.result;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // ===== PHOTO LOADING =====
        async function loadPhotosForEvent(eventTag) {
            const config = EVENT_CONFIG[eventTag];
            if (!config) return;

            const gallery = document.getElementById(config.gallery);
            gallery.innerHTML = `
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <p style="opacity: 0.4; font-size: 0.85rem;">Loading memories...</p>
                </div>
            `;

            try {
                const url = `${WORKER_URL}/photos?eventTag=${encodeURIComponent(eventTag)}`;
                const response = await fetch(url);

                if (!response.ok) throw new Error(`HTTP ${response.status}`);

                const photos = await response.json();
                renderPhotos(photos, gallery, eventTag);
            } catch (error) {
                console.error(`Error loading ${eventTag}:`, error);
                gallery.innerHTML = `
                    <div class="empty-state">
                        <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M12 8v4M12 16h.01"/>
                        </svg>
                        <p class="empty-state-title">Unable to load</p>
                        <p class="empty-state-text">Please refresh to try again</p>
                    </div>
                `;
            }
        }

        function renderPhotos(photos, gallery, eventTag) {
            if (!photos || photos.length === 0) {
                gallery.innerHTML = `
                    <div class="empty-state">
                        <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                            <circle cx="8.5" cy="8.5" r="1.5"/>
                            <path d="M21 15l-5-5L5 21"/>
                        </svg>
                        <p class="empty-state-title">No memories yet</p>
                        <p class="empty-state-text">Be the first to share a moment</p>
                    </div>
                `;
                return;
            }

            gallery.innerHTML = '';

            photos.forEach((photo) => {
                const hasCaption = photo.name || photo.message;
                const card = document.createElement('div');
                card.className = `photo-card${hasCaption ? '' : ' no-caption'}`;

                card.innerHTML = `
                    <div class="photo-item">
                        <img src="${photo.url}" alt="Memory shared by ${photo.name || 'Guest'}" loading="lazy">
                    </div>
                    <div class="photo-caption">
                        ${photo.name ? `<p class="photo-name">${photo.name}</p>` : ''}
                        ${photo.message ? `<p class="photo-message">"${photo.message}"</p>` : ''}
                    </div>
                `;
                gallery.appendChild(card);
            });

            // Setup scroll-in entrance animations
            setupPhotoEntranceObserver(gallery);
        }

        // ===== PHOTO ENTRANCE ANIMATION =====
        function setupPhotoEntranceObserver(gallery) {
            const photoCards = gallery.querySelectorAll('.photo-card');

            const entranceObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // Add visible class for fade-in + slide-up
                        entry.target.classList.add('visible');
                        // Stop observing once visible
                        entranceObserver.unobserve(entry.target);
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px' // Trigger slightly before fully in view
            });

            photoCards.forEach(card => entranceObserver.observe(card));
        }

        // ===== UPLOAD FUNCTIONALITY =====
        async function uploadPhoto(file, name, message, eventTag) {
                const uploadBtn = document.getElementById('uploadBtn');
            const originalText = uploadBtn.textContent;

            try {
                uploadBtn.disabled = true;
                uploadBtn.textContent = 'Sharing...';

                const currentPassword = urlParams.get('pass');
                if (!currentPassword || !validPasswords.includes(currentPassword)) {
                    throw new Error('Valid access required');
                }

                const resizedBlob = await resizeImage(file);
                const formData = new FormData();
                formData.append('image', resizedBlob, `${generateUUID()}.jpg`);
                formData.append('name', name || 'Anonymous');
                formData.append('message', message || '');
                formData.append('eventTag', eventTag);
                formData.append('pass', currentPassword);

                const response = await fetch(`${WORKER_URL}/upload`, { method: 'POST', body: formData });

                if (!response.ok) {
                    const error = await response.json().catch(() => ({ error: 'Upload failed' }));
                    throw new Error(error.error || 'Upload failed');
                }

                closeModal();
                document.getElementById('photoForm').reset();
                document.getElementById('uploadPreview').innerHTML = `
                    <svg class="upload-zone-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                        <circle cx="8.5" cy="8.5" r="1.5"/>
                        <path d="M21 15l-5-5L5 21"/>
                    </svg>
                    <p class="upload-zone-text">Tap to select a photo</p>
                `;

                await loadPhotosForEvent(eventTag);
            } catch (error) {
                console.error('Upload error:', error);
                alert(`Unable to share: ${error.message}`);
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.textContent = originalText;
            }
        }

        // ===== MODAL CONTROL =====
        function openModal(eventTag) {
            const config = EVENT_CONFIG[eventTag];
            if (!config) return;

            currentEventTag = eventTag;
            document.getElementById('hiddenEventTag').value = eventTag;
            document.getElementById('eventIndicator').textContent = config.label;
            document.getElementById('uploadModal').classList.add('visible');
                document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('uploadModal').classList.remove('visible');
            document.body.style.overflow = '';
                document.getElementById('hiddenFileInput').value = '';
            }

        // ===== SCROLL & NAVIGATION =====
        function setupScrollObserver() {
            const sections = document.querySelectorAll('.gallery-section');
            const navItems = document.querySelectorAll('.nav-item');

            // Track intersection ratios for all sections
            const sectionVisibility = new Map();

            const observer = new IntersectionObserver(entries => {
                // Update visibility map with latest intersection ratios
                entries.forEach(entry => {
                    sectionVisibility.set(entry.target, entry.intersectionRatio);
                });

                // Find the section with the highest visibility
                let maxRatio = 0;
                let activeSection = null;

                sectionVisibility.forEach((ratio, section) => {
                    if (ratio > maxRatio) {
                        maxRatio = ratio;
                        activeSection = section;
                    }
                });

                // Apply theme for the most visible section (with minimum threshold)
                if (activeSection && maxRatio > 0.1) {
                    const theme = activeSection.dataset.theme;
                    const event = activeSection.dataset.event;

                    if (currentEventTag !== event) {
                        applyTheme(theme);
                        currentEventTag = event;

                        navItems.forEach(item => {
                            item.classList.toggle('active', item.dataset.event === event);
                        });
                    }
                }
            }, { threshold: [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0] });

            sections.forEach(section => observer.observe(section));
        }

        // ===== DEBUG PANEL =====
        function setupDebugPanel() {
            if (!isLocalhost) return;

            const panel = document.createElement('div');
            panel.className = 'debug-panel';
            panel.innerHTML = `
                <div class="debug-panel-title">Debug</div>
                <button id="debugToggle" class="${debugMode ? 'active' : ''}">
                    Debug: ${debugMode ? 'ON' : 'OFF'}
                </button>
                <button id="debugN" class="${password === 'N2026' ? 'active' : ''}">N2026</button>
                <button id="debugS" class="${password === 'S2026' ? 'active' : ''}">S2026</button>
                <button id="debugT" class="${password === 'T2026' ? 'active' : ''}">T2026</button>
            `;
            document.body.appendChild(panel);

                let debugEnabled = debugMode;
            window.debugMode = debugEnabled;

            document.getElementById('debugToggle').addEventListener('click', () => {
                debugEnabled = !debugEnabled;
                    window.debugMode = debugEnabled;
                const btn = document.getElementById('debugToggle');
                btn.textContent = `Debug: ${debugEnabled ? 'ON' : 'OFF'}`;
                btn.classList.toggle('active', debugEnabled);

                    const url = new URL(window.location);
                debugEnabled ? url.searchParams.set('debug', 'true') : url.searchParams.delete('debug');
                    window.history.replaceState({}, '', url);

                setupUploadButton();
            });

            ['N', 'S', 'T'].forEach(code => {
                document.getElementById(`debug${code}`).addEventListener('click', () => {
                    const url = new URL(window.location);
                    url.searchParams.set('pass', `${code}2026`);
                    if (debugEnabled) url.searchParams.set('debug', 'true');
                    window.location.href = url.toString();
                });
            });
        }

        // ===== SETUP UPLOAD BUTTON =====
        function setupUploadButton() {
            const uploadCta = document.getElementById('uploadCta');
            const shouldShow = hasValidPassword && (debugMode || isEventDate() || window.debugMode);
            uploadCta.classList.toggle('hidden', !shouldShow);
        }

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', () => {
            // Load all galleries
            Object.keys(EVENT_CONFIG).forEach(loadPhotosForEvent);

            // Setup scroll observer
            setupScrollObserver();

            // Setup upload button
            setupUploadButton();

            // Navigation clicks
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    const sectionId = item.dataset.section;
                    document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
                });
            });

            // Upload CTA click
            document.getElementById('uploadCta').addEventListener('click', () => {
                document.getElementById('hiddenFileInput').click();
            });

            // Hidden file input change
            document.getElementById('hiddenFileInput').addEventListener('change', e => {
                            const file = e.target.files[0];
                            if (file) {
                    const eventTag = currentEventTag || getDefaultEventTag();
                    openModal(eventTag);

                    // Show preview (uncropped)
                    const reader = new FileReader();
                    reader.onload = evt => {
                        document.getElementById('uploadPreview').innerHTML = `
                            <div class="upload-preview">
                                <img src="${evt.target.result}" alt="Preview">
                                <p class="upload-preview-hint">Your photo will appear exactly like this</p>
                            </div>
                        `;
                    };
                    reader.readAsDataURL(file);

                    // Set file to form input
                    const dataTransfer = new DataTransfer();
                    dataTransfer.items.add(file);
                    document.getElementById('photoFile').files = dataTransfer.files;
                }
            });

            // Upload zone click
            document.getElementById('uploadZone').addEventListener('click', () => {
                    document.getElementById('photoFile').click();
                });

            // Photo file change in modal
            document.getElementById('photoFile').addEventListener('change', e => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = evt => {
                        document.getElementById('uploadPreview').innerHTML = `
                            <div class="upload-preview">
                                <img src="${evt.target.result}" alt="Preview">
                                <p class="upload-preview-hint">Your photo will appear exactly like this</p>
                            </div>
                        `;
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Form submission
            document.getElementById('photoForm').addEventListener('submit', async e => {
                e.preventDefault();
                const file = document.getElementById('photoFile').files[0];
                const name = document.getElementById('photoName').value.trim();
                const message = document.getElementById('photoMessage').value.trim();
                const eventTag = document.getElementById('hiddenEventTag').value;

                if (!file) {
                    alert('Please select a photo');
                    return;
                }
                if (!eventTag) {
                    alert('Event not selected');
                    return;
                }

                await uploadPhoto(file, name, message, eventTag);
            });

            // Modal close handlers
            document.getElementById('modalBackdrop').addEventListener('click', closeModal);
            document.getElementById('modalClose').addEventListener('click', closeModal);

            // Debug panel
            setupDebugPanel();

            // Initial theme based on password
            if (hasValidPassword) {
                const defaultEvent = getDefaultEventTag();
                const config = EVENT_CONFIG[defaultEvent];
                if (config) {
                    currentEventTag = defaultEvent;
                    setTimeout(() => {
                        document.getElementById(config.section).scrollIntoView({ behavior: 'smooth' });
                    }, 500);
                }
            }
        });
    </script>
</body>
</html>
